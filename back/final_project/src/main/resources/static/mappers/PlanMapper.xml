<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.floating.mvc.dao.PlanDao">

	<!-- Plan을 추가한다. -->
	<insert id="insertPlan" useGeneratedKeys="true" keyProperty="planPk">
		INSERT INTO plan(date, category, detail, time, complete_date, shifted, id)
		VALUES (
			#{plan.date}, 
			#{plan.category}, 
			#{plan.detail}, 
			#{plan.time}, 
			#{plan.completeDate}, 
			#{plan.shifted}, 
			#{userId}
		)
	</insert>

	<!-- Plan 정보 전체를 조회한다. -->
	<select id="selectAll">
		SELECT * FROM plan
		WHERE user_id = #{userId}
	</select>
	
	<!-- Plan 정보 일부를 조회한다. -->
	<select id="selectPlan" resultType="PlanRequestDto">
		SELECT * FROM plan 
		WHERE plan_pk = #{planPk} AND user_id = #{userId}
		
	</select>
	
	<!-- Plan 정보를 수정한다. -->
	<update id="updatePlan">
		UPDATE plan
		SET
			date = #{date},
			category = #{category},
			detail = #{detail},
			time = #{time},
			complete_date = #{completeDate},
			shifted = #{shifted}
		WHERE plan_pk = #{planPk}
	</update>
	
	<update id="postPlanCompl">
		UPDATE plan
		SET
			complete_date = #{completeDate}
		WHERE plan_pk = #{planPk}
	</update>
</mapper>